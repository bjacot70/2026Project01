(function(){"use strict";var s;(function(e){e.clear="clear",e.init="init",e.store="store",e.load="load",e.success="success",e.error="error"})(s||(s={}));class l{message;data;constructor(i,t){this.message=i,this.data=t}}var a;let u,c;function f(e,i,t,o=1){u=e.location+"_"+e.version,c="data_"+e.version;let r=indexedDB.open(u,o);r.onupgradeneeded=function(n){a=n.target.result,a.createObjectStore(c)},r.onsuccess=function(n){a=r.result;let d=new l(s.success,{message:"database initialized"});self.postMessage(d)},r.onerror=function(n){let d=new l(s.error,{message:"error while init database"});self.postMessage(d)}}function g(e){if(a==null){console.error("IndexedDb not initialized! Storing data not possible.");return}let t=a.transaction(c,"readwrite").objectStore(c),o;e.key!=null?(e.data!=null?o=t.put(e.data,e.key):o=t.delete(e.key),o.onsuccess=()=>{self.postMessage(new l(s.store,{message:"stored element for key: "+e.key}))},o.onerror=function(r){self.postMessage(new l(s.error,{message:"error storeing element for key: "+e.key}))}):console.log("idbworker error: no key provide to store data")}async function b(){if(a==null){console.error("IndexedDb not initialized! Loading data not possible.");return}let i=a.transaction(c,"readonly").objectStore(c),t={},o=i.openCursor();o.onerror=function(r){self.postMessage(new l(s.error,{message:"error loading data"}))},o.onsuccess=function(r){if(r!=null){let n=r.target.result;if(n){let d=n.primaryKey,k=n.value;t[d]=k,n.continue()}else self.postMessage(new l(s.load,{message:"loaded all data from database",data:t}))}}}async function m(e){u=e.location+"_"+e.version,indexedDB.deleteDatabase(u)}onmessage=function(i){let t=i.data;switch(t.message){case s.init:{f(t.data);break}case s.store:{g(t.data);break}case s.load:{b();break}case s.clear:{m(t.data);break}}}})();
